# Base Directories
{{ if eq .chezmoi.os "darwin" -}}
CACHE_DIR="${HOME}/Library/Caches"
STATE_DIR="${HOME}/Library/Application Support"
{{- else -}}
CACHE_DIR="${HOME}/.cache"
STATE_DIR="${HOME}/.local/state"
{{- end }}

export CARGO_HOME="${HOME}/.cargo"
export ETCDCTL_API=3
export GITHUB_TOKEN={{ .github.token }}
export GOPATH="${HOME}/.go"
export GOCACHE="$CACHE_DIR/go/build"
export GOMODCACHE="$CACHE_DIR/go/mod"
export HOMEBREW_NO_INSTALL_CLEANUP=1
export HOMEBREW_CASK_OPTS="--no-quarantine"
export HOMEBREW_GITHUB_API_TOKEN={{ .github.token }}
export NIXPKGS_ALLOW_INSECURE=1
export NIXPKGS_ALLOW_UNFREE=1
export NPM_CONFIG_USERCONFIG="${HOME}/.config/npm/npmrc"
export REDISCLI_HISTFILE="${STATE_DIR}/redis/history"
export TRUNK_MIXPANEL=off
export VSCE_PAT={{ .vsce.token }}
export WGETRC="${HOME}/.config/wgetrc"

export HTTP_PROXY=http://127.0.0.1:7890
export HTTPS_PROXY=http://127.0.0.1:7890
export ALL_PROXY=socks5://127.0.0.1:7890
export http_proxy=http://127.0.0.1:7890
export https_proxy=http://127.0.0.1:7890
export all_proxy=socks5://127.0.0.1:7890

skip_global_compinit=1

# FPATH
FUNC_DIRS=(
  ${HOME}/.local/state/nix/profile/share/zsh/site-functions
  /usr/share/zsh/site-functions
  /usr/share/zsh/vendor-completions
  /opt/homebrew/share/zsh/site-functions
)
for FUNC_DIR in ${FUNC_DIRS[@]}; do
  FPATH="$FUNC_DIR:$FPATH"
done

{{ if eq .chezmoi.os "linux" -}}
# Nix
if [ -e ${HOME}/.local/state/nix/profile/etc/profile.d/nix.sh ]; then
  source ${HOME}/.local/state/nix/profile/etc/profile.d/nix.sh
fi
{{ end -}}

{{ if eq .chezmoi.os "darwin" -}}
# Homebrew
{{ if eq .chezmoi.arch "arm64" -}}
if [ -f /opt/homebrew/bin/brew ]; then
  eval $(/opt/homebrew/bin/brew shellenv)
fi
{{ else -}}
if [ -f /usr/local/bin/brew ]; then
  eval $(/usr/local/bin/brew shellenv)
fi
{{ end -}}
{{ end -}}
